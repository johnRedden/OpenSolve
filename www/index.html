<!DOCTYPE html>
<html>
<!--
  * Open Source Symbolic Project
  Rachel made a change!
  -->
<head>
    <title>Open CAS</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">

    <!-- see http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag -->
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=no">
    <style>
        /* following two viewport lines are equivalent to meta viewport statement above, needed for Windows */
        /* see http://www.quirksmode.org/blog/archives/2014/05/html5_dev_conf.html and http://dev.w3.org/csswg/css-device-adapt/ */
        @-ms-viewport { width: 100vw ; min-zoom: 100% ; zoom: 100% ; }  @viewport { width: 100vw ; min-zoom: 100% zoom: 100% ; }
        @-ms-viewport { user-zoom: fixed ; min-zoom: 100% ; }           @viewport { user-zoom: fixed ; min-zoom: 100% ; }
    </style>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="js/algebrite.js"></script>
    
    <!-- Latest compiled and minified bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    
    
    

    <!-- Uncomment the following scripts if you convert your "Standard HTML5" project into a "Cordova" project. -->
    <!-- <script src="cordova.js"></script> -->          <!-- phantom library, needed for Cordova api calls, added during build -->
    <!-- <script src="js/app.js"></script> -->           <!-- recommended location of your JavaScript code relative to other JS files -->
    <!-- <script src="xdk/init-dev.js"></script> -->     <!-- normalizes device and document ready events, see README for details -->
</head>

<body>

    <div class="container">
        <h2>Open Solve</h2>
        <hr>
        <div class="row">
          <div class="col-lg-12">
            <div class="input-group">
              <input id="userInput" type="text" class="form-control" aria-label="..." autofocus>
              <div class="input-group-btn">
                <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Action <span class="caret"></span></button>
                <ul class="dropdown-menu dropdown-menu-right">
                  <li><a href="#evaluate" command="eval">Evaluate</a></li>
                  <li><a href="#simplify" command="simplify">Simplify</a></li>
                  <li><a href="#solve" command="roots">Solve</a></li>
                  <li><a href="#derivative" command="d">Derivative</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="#">More Commands Soon!</a></li>
                </ul>
              </div><!-- /btn-group -->
            </div><!-- /input-group -->
          </div><!-- /.col-lg-6 -->
        </div><!-- /.row -->
        <hr>
        <p> </p>
        <pre id="mainResult" class="text-center">Enter Ascii Math</pre>
        <p> </p>
        <pre id="steps" class="text-center">Steps Maybe</pre>
        <p> </p>
        <a href="http://algebrite.org/reference.html" target="_blank">Function Ref.</a>
        
    </div>
   
    
    <script>
        
        $('document').ready(function(){
            
            $('#userInput').on('keyup',function(e){
                var inputTxt = $(this).val().trim();
                var output = mathWorks(inputTxt, '');
                mathSimpleDisplay(output);
            });
            
            $('.dropdown-menu a').click(function(){
                var cmd = $(this).attr('command');
                var inputTxt = $('#userInput').val().trim();
                var output = mathWorks(inputTxt, cmd);
                mathSimpleDisplay(output);
                
                if(cmd=='roots') $('#steps').html(mathSolve(inputTxt)) ;
            });
            
        });
        
        // utility functions
        function mathWorks(asciiMath, command){
            var resultTxt = "";
            var commandStr = command+'('+asciiMath+')';
            if(asciiMath==="") 
                    resultTxt="Enter Ascii Math";
            else
                    resultTxt = '= '+Algebrite.run(commandStr);
            
            return {
                command:commandStr,
                result: resultTxt
            }
        }
        function mathSimpleDisplay(arg){
            $('#mainResult').html(arg.command+'<br/>'+arg.result);
        }
        
        function mathSolve(arg){
            
            var lhs = arg.substr(0,arg.indexOf('='));
            var rhs = arg.substr(arg.indexOf('=')+1, arg.length);
            if(lhs===''){
                lhs=rhs;
                rhs='0';
            }
            
            var lhsDeg = Algebrite.run('deg('+lhs+')');
            var rhsDeg = Algebrite.run('deg('+rhs+')');
            
            console.log(lhsDeg +' -- '+rhsDeg);
            
            var outHTML ='No steps detected.';
            
            
            if((lhsDeg==='1'||lhsDeg==='0') && (rhsDeg==='0'||rhsDeg==='1')){
                outHTML = mathSolveGeneralLinear(lhs,rhs);
            }
            
            return outHTML;
            
        }
        function mathSolveGeneralLinear(lhs, rhs){
            var outHTML = 'Solving Linear Equations <br/>';
            
            //special case ax+b=c
            outHTML += lhs +' = '+rhs+'<br/>';
            
            outHTML += 'Add same-side like terms.<br/>';
            simplifiedlhs = Algebrite.run(lhs);
            simplifiedrhs = Algebrite.run(rhs);
            outHTML += simplifiedlhs +' = '+simplifiedrhs+'<br/>';
            
            var lt = Algebrite.run('coeff('+simplifiedrhs+',x,1)'); //coeff of deg 1 term
            var opplt = Algebrite.run('-1('+lt+')'); //opposite
            outHTML += 'Combine opposite-side like terms. Add '+opplt+'x to both sides<br/>';
            simplifiedlhs = Algebrite.run(simplifiedlhs+'+('+opplt+'x)');
            simplifiedrhs = Algebrite.run(simplifiedrhs+'+('+opplt+'x)');
            outHTML += simplifiedlhs +' = '+simplifiedrhs+'<br/>';
            

            var a = Algebrite.run('coeff('+simplifiedlhs+',x,1)'); //coeff of deg 1 term
            var b = Algebrite.run('coeff('+simplifiedrhs+',x,0)'); //coeff of deg 0 term
            var c = simplifiedrhs;

            var cminusb = Algebrite.run(c+'-('+b+')');
            var oppb = Algebrite.run('-1('+b+')'); //coeff of deg 0 term

            outHTML += 'Add '+oppb+' to both sides.<br/>';
            outHTML += a+'x = '+ cminusb+'<br/>';
            outHTML += 'Divide both sides by '+a+'<br/>';
            outHTML += 'x = '+cminusb+'/'+a;
            
            return outHTML;

        }
        

    </script>

</body>
</html>
