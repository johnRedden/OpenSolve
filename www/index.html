<!DOCTYPE html>
<html>
<!--
  * Open Source Symbolic Project
  Rachel made a change!
  -->
<head>
    <title>Open CAS</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">

    <!-- see http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag -->
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=no">
    <style>
        /* following two viewport lines are equivalent to meta viewport statement above, needed for Windows */
        /* see http://www.quirksmode.org/blog/archives/2014/05/html5_dev_conf.html and http://dev.w3.org/csswg/css-device-adapt/ */
        @-ms-viewport { width: 100vw ; min-zoom: 100% ; zoom: 100% ; }  @viewport { width: 100vw ; min-zoom: 100% zoom: 100% ; }
        @-ms-viewport { user-zoom: fixed ; min-zoom: 100% ; }           @viewport { user-zoom: fixed ; min-zoom: 100% ; }
    </style>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="js/algebrite.js"></script>
    <script src="js/openmathsteps.js"></script>
    
    <!-- Latest compiled and minified bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <script type="text/javascript" async
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
    
    

    <!-- Uncomment the following scripts if you convert your "Standard HTML5" project into a "Cordova" project. -->
    <!-- <script src="cordova.js"></script> -->          <!-- phantom library, needed for Cordova api calls, added during build -->
    <!-- <script src="js/app.js"></script> -->           <!-- recommended location of your JavaScript code relative to other JS files -->
    <!-- <script src="xdk/init-dev.js"></script> -->     <!-- normalizes device and document ready events, see README for details -->
</head>

<body>

    <div class="container">
        <h2>Open Solve</h2>
        <hr>
        <div class="row">
          <div class="col-lg-12">
            <div class="input-group">
              <input id="userInput" type="text" class="form-control" aria-label="..." autofocus>
              <div class="input-group-btn">
                <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Action <span class="caret"></span></button>
                <ul class="dropdown-menu dropdown-menu-right">
                  <li><a href="#evaluate" command="eval">Evaluate</a></li>
                  <li><a href="#simplify" command="simplify">Simplify</a></li>
                  <li><a href="#solve" command="roots">Solve</a></li>
                  <li><a href="#derivative" command="d">Derivative</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="#">More Commands Soon!</a></li>
                </ul>
              </div><!-- /btn-group -->
            </div><!-- /input-group -->
          </div><!-- /.col-lg-6 -->
        </div><!-- /.row -->
        <hr>
        <p> </p>
        <pre id="mainResult" class="text-center">Algebrite onKeyup Ascii Math</pre>
        <p> </p>
        <div id="niceResult" class="well text-center"  class="text-center">Enter for nice display.</div>
        <p> </p>
        <pre id="steps" class="text-center">Steps Maybe</pre>
        <p> </p>
        <a href="http://algebrite.org/reference.html" target="_blank">Algebrite Function Ref.</a><br/>
        <a href="http://asciimath.org/" target="_blank">Ascii math Ref.</a>
        
    </div>
   
    
    <script>
        
        $('document').ready(function(){
            //Your awesome javascript goes here.
            
            $('#userInput').on('keyup',function(e){
                var inputTxt = $(this).val().trim();
                var output = mathWorks(inputTxt, '');
                mathSimpleDisplay(output);
                if(e.keyCode == 13)
                    mathJaxDisplay(output);
            });
            
            $('.dropdown-menu a').click(function(){
                var cmd = $(this).attr('command');
                var inputTxt = $('#userInput').val().trim();
                var output = mathWorks(inputTxt, cmd);
                mathSimpleDisplay(output);
                
                
                //steps for solving detected here
                if(cmd=='roots') $('#steps').html(mathSolve(inputTxt)) ;
            });
            
        });
        
        // utility functions
        function mathWorks(asciiMath, command){
            var resultTxt = "";
            var commandStr = command+'('+asciiMath+')';
            if(asciiMath==="") 
                    resultTxt="Enter Ascii Math";
            else
                    resultTxt = '= '+Algebrite.run(commandStr);
            
            return {
                rawInput: asciiMath,
                command:commandStr,
                result: resultTxt
            }
        }
        
        function mathSimpleDisplay(arg){
            $('#mainResult').html(arg.command+'<br/>'+arg.result);
        }
        function mathJaxDisplay(arg){
            //Mathjax renders ascii math between back ticks
            $('#niceResult').html('`'+arg.rawInput+' '+arg.result+'`<br/>');
            MathJax.Hub.Queue(["Typeset",MathJax.Hub,"niceResult"]);
        }
        
        function mathSolve(arg){
            
            var lhs = arg.substr(0,arg.indexOf('='));
            var rhs = arg.substr(arg.indexOf('=')+1, arg.length);
            if(lhs===''){
                lhs=rhs;
                rhs='0';
            }
            
            var lhsDeg = Algebrite.run('deg('+lhs+')');
            var rhsDeg = Algebrite.run('deg('+rhs+')');
            
            
            var outHTML ='No steps detected.';
            
            
            if((lhsDeg==='1'||lhsDeg==='0') && (rhsDeg==='0'||rhsDeg==='1')){
                outHTML = mathSolveGeneralLinear(lhs,rhs);
            }
            if((lhsDeg==='2') || (rhsDeg==='2')){ //need better logic here
                outHTML = mathSolveGeneralQuadratic(lhs,rhs);
            }
            
            return outHTML;
            
        }

        

    </script>

</body>
</html>
